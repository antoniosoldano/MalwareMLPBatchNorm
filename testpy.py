import time
import numpy as np
import pandas.core.frame as frame
from torchvision import datasets
from torchvision import transforms
from torch.utils.data import DataLoader
from sklearn.model_selection import train_test_split
import pandas as pd
import torch.nn.functional as F
import torch
import wandb
from MultilayerPerceptron import MultilayerPerceptron
from DikeDataset import DikeDataset
import math


dataFrame = pd.read_csv('dataset/benign.csv')
dataFrame = dataFrame.sample(frac=1)
values = np.array(dataFrame.values.astype(np.str_))

print(values[0])
print(type(values[0]))

n_rows = values.shape[0]
n_train = math.floor((n_rows * 25) /100)
n_test = n_rows - n_train

train_dataset = DikeDataset(values[0:n_train, 0:-2],values[0:n_train, -2])
test_dataset = DikeDataset(values[n_train:, 0:-2],values[n_train:, -2])

batch_size = 64

train_loader = DataLoader(dataset=train_dataset,
                          batch_size=batch_size,
                          shuffle=False)

test_loader = DataLoader(dataset=test_dataset,
                         batch_size=batch_size,
                         shuffle=False)

print(train_dataset.__getitem__(0))
